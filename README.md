 # MarkItDown 文件转换器

一个基于 MarkItDown 的图形化文件转换工具，可以将各种格式的文件转换为 Markdown 格式。

## 功能特点

- 🎯 **图形化界面**：简洁直观的 Tkinter GUI
- 📁 **文件拖拽**：支持直接拖拽文件到界面
- 🌐 **URL 支持**：可以直接转换网页内容
- 📊 **多格式支持**：支持 PDF、Word、PowerPoint、Excel、图像等多种文件格式
- 💾 **便捷保存**：一键保存转换结果为 Markdown 文件
- ⚡ **异步处理**：后台转换，界面不卡顿

## 支持的文件格式

- **文档格式**：PDF、DOCX、PPTX、XLSX、XLS
- **网页格式**：HTML、EPUB
- **图像格式**：JPG、JPEG、PNG、GIF、BMP
- **数据格式**：CSV
- **网页链接**：HTTP/HTTPS URL

## 安装要求

- Python 3.7+
- Windows/macOS/Linux

## 安装步骤

1. 克隆或下载项目文件
2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```

## 使用方法

1. 运行程序：
   ```bash
   python markitdown_ui.py
   ```

2. 选择文件：
   - 点击"浏览"按钮选择文件
   - 或直接将文件拖拽到文件路径框中
   - 或在URL框中输入网页链接

3. 转换文件：
   - 点击"转换为Markdown"按钮
   - 等待转换完成，结果将显示在下方文本框中

4. 保存结果：
   - 点击"保存结果"按钮
   - 选择保存位置和文件名
   - 文件将以 .md 格式保存

## 界面说明

- **文件选择区域**：支持浏览选择文件或拖拽文件
- **URL输入区域**：用于输入要转换的网页链接
- **转换按钮**：执行文件转换操作
- **进度显示**：显示转换进度（转换时出现）
- **结果显示**：查看转换后的Markdown内容
- **状态栏**：显示当前操作状态

## 特殊功能

### 文件拖拽
支持直接将文件从文件管理器拖拽到程序界面的文件路径框中。

### 智能文件命名
保存时会自动使用原文件名（去除扩展名）作为默认文件名，并自动清理文件名中的非法字符。

### 异步转换
转换过程在后台线程中进行，不会阻塞用户界面，确保良好的用户体验。

## 错误处理

程序具备完善的错误处理机制：
- 不支持的文件格式提示
- 缺少依赖包的提示和解决方案
- 文件读取失败的错误提示
- 网络连接问题的错误提示

## 依赖说明

主要依赖包：
- `markitdown[all]`：核心转换引擎，包含所有可选依赖
- `tkinterdnd2`：实现文件拖拽功能

## 注意事项

1. 首次使用时，MarkItDown 可能需要下载一些模型文件，请确保网络连接正常
2. 某些复杂的 PDF 文件可能转换时间较长
3. 图像文件转换需要 OCR 功能，确保相关依赖已正确安装
4. 转换大文件时建议关闭其他占用内存的程序

## 故障排除

### 常见问题

**Q: 提示"无法导入markitdown库"**
A: 请运行 `pip install markitdown[all]` 安装完整版本

**Q: 图像文件无法转换**
A: 确保安装了 OCR 相关依赖，运行 `pip install markitdown[ocr]`

**Q: PDF 转换失败**
A: 确保安装了 PDF 处理依赖，运行 `pip install markitdown[pdf]`

**Q: 程序界面显示不正常**
A: 确保安装了 `tkinterdnd2`，运行 `pip install tkinterdnd2`

## 开源协议

本项目基于 MIT 协议开源。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 更新日志

### v1.0
- 基本的文件转换功能
- 图形化用户界面
- 文件拖拽支持
- URL 转换支持
- 异步处理和进度显示